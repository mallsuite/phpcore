<?php
// +----------------------------------------------------------------------
// | ShopSuite商城系统 [ 赋能开发者，助力企业发展 ]
// +----------------------------------------------------------------------
// | 版权所有 随商信息技术（上海）有限公司
// +----------------------------------------------------------------------
// | 未获商业授权前，不得将本软件用于商业用途。禁止整体或任何部分基础上以发展任何派生版本、
// | 修改版本或第三方版本用于重新分发。
// +----------------------------------------------------------------------
// | 官方网站: https://www.shopsuite.cn  https://www.kuteshop.cn
// +----------------------------------------------------------------------
// | 版权和免责声明:
// | 本公司对该软件产品拥有知识产权（包括但不限于商标权、专利权、著作权、商业秘密等）
// | 均受到相关法律法规的保护，任何个人、组织和单位不得在未经本团队书面授权的情况下对所授权
// | 软件框架产品本身申请相关的知识产权，禁止用于任何违法、侵害他人合法权益等恶意的行为，禁
// | 止用于任何违反我国法律法规的一切项目研发，任何个人、组织和单位用于项目研发而产生的任何
// | 意外、疏忽、合约毁坏、诽谤、版权或知识产权侵犯及其造成的损失 (包括但不限于直接、间接、
// | 附带或衍生的损失等)，本团队不承担任何法律责任，本软件框架只能用于公司和个人内部的
// | 法律所允许的合法合规的软件产品研发，详细见https://www.golershop.cn/policy
// +----------------------------------------------------------------------
 namespace Kuteshop\Core\Repository; use App\Exceptions\ErrorException; use Closure; use Prettus\Repository\Eloquent\BaseRepository as BaseRepositoryEloquent; abstract class BaseRepository extends BaseRepositoryEloquent implements BaseRepositoryEloquentInterface { public function add(array $tWbtB) { return parent::create($tWbtB); } public function edit($RxOxB, array $tWbtB) { return parent::update($tWbtB, $RxOxB); } public function addBatch($R3wwf) { $CVHzV = $this->model->insert($R3wwf); return $CVHzV; } public function edits(array $afw6o, array $tWbtB) { goto pn52t; z3GsM: $CPW3O = $this->model->getKeyName(); goto joBLT; CzqVX: gYm5a: goto KkPIg; pn52t: if (!(count($afw6o) > 0)) { goto gYm5a; } goto z3GsM; joBLT: $CVHzV = $this->model->whereIn($CPW3O, $afw6o)->update($tWbtB); goto z7Aci; kTD7s: return $CVHzV; goto CzqVX; z7Aci: $this->resetModel(); goto kTD7s; KkPIg: return 0; goto uX0mz; uX0mz: } public function editWhere(array $ate9G, array $tWbtB) { $afw6o = $this->findKey($ate9G); return $this->edits($afw6o, $tWbtB); } public function save(array $tWbtB, array $Q9HFS = array()) { return parent::updateOrCreate($tWbtB, $Q9HFS); } public function remove($RxOxB) { goto eumL1; eumL1: $CVHzV = $this->model->destroy($RxOxB); goto gcBja; LMkU_: return $CVHzV; goto qIHZI; gcBja: $this->resetModel(); goto LMkU_; qIHZI: } public function removeWhere(array $ate9G) { goto eJY_a; KH9gc: Ba4dD: goto ppPW5; eJY_a: $afw6o = $this->findKey($ate9G); goto ABviN; ABviN: if (!(count($afw6o) > 0)) { goto Ba4dD; } goto lTZCQ; lTZCQ: return $this->remove($afw6o); goto KH9gc; ppPW5: return 0; goto iAtQ8; iAtQ8: } protected function applyConditions(array $ate9G) { foreach ($ate9G as $de_NJ => $JCs88) { goto grsDD; eNOsD: s73zl: goto OTT4g; pcJK9: list($de_NJ, $Y3Cc0, $BMgJx) = $JCs88; goto Jk0On; wW0lU: QyErg: goto URI26; grsDD: if (is_array($JCs88)) { goto rpAl2; } goto YiWkA; YiWkA: $this->model = $this->model->where($de_NJ, "\x3d", $JCs88); goto GVwAt; eDbyR: Dux0t: goto zgrZL; OTT4g: vYt2o: goto mIcWT; zgrZL: $Y3Cc0 = $uGSQM[0]; goto vhwn9; jaAJB: $uGSQM = explode("\40", $Y3Cc0); goto KxP7C; GVwAt: goto vYt2o; goto kgW17; URI26: switch (strtoupper($Y3Cc0)) { case "\x49\116": goto eq3rS; eq3rS: if (is_array($BMgJx)) { goto IUfx1; } goto Nbd7B; aUpNF: IUfx1: goto QmcQK; Nbd7B: throw new ErrorException("\111\x6e\160\165\164\x20{$BMgJx}\40\155\165\x73\x20\x62\145\40\141\x6e\x20\x61\162\x72\x61\x79"); goto aUpNF; QmcQK: $this->model = $this->model->whereIn($de_NJ, $BMgJx); goto gqkNK; gqkNK: goto s73zl; goto eTi8t; eTi8t: case "\116\x4f\124\111\x4e": goto EJJOq; eOMPB: $this->model = $this->model->whereNotIn($de_NJ, $BMgJx); goto lpN2c; tswGS: d4Hp4: goto eOMPB; SM1oX: throw new ErrorException("\111\156\160\165\x74\40{$BMgJx}\40\155\165\163\40\x62\x65\40\141\156\40\x61\162\x72\141\x79"); goto tswGS; lpN2c: goto s73zl; goto Z3fiE; EJJOq: if (is_array($BMgJx)) { goto d4Hp4; } goto SM1oX; Z3fiE: case "\104\x41\124\105": goto OUCzu; fXI09: $uGSQM = "\75"; goto HWEz2; HWEz2: mlS5z: goto ybaka; Vx5UJ: goto s73zl; goto gEGUx; ybaka: $this->model = $this->model->whereDate($de_NJ, $uGSQM, $BMgJx); goto Vx5UJ; OUCzu: if ($uGSQM) { goto mlS5z; } goto fXI09; gEGUx: case "\x44\x41\131": goto m3wSq; m3wSq: if ($uGSQM) { goto RU63s; } goto U0dXF; kzKRr: goto s73zl; goto VvS2p; OWjrI: RU63s: goto lB2rv; lB2rv: $this->model = $this->model->whereDay($de_NJ, $uGSQM, $BMgJx); goto kzKRr; U0dXF: $uGSQM = "\75"; goto OWjrI; VvS2p: case "\x4d\117\116\124\110": goto sd_I9; n43Mv: goto s73zl; goto HjJmI; sd_I9: if ($uGSQM) { goto xEDq_; } goto TRI_2; TRI_2: $uGSQM = "\75"; goto V2xh7; V2xh7: xEDq_: goto tRSIm; tRSIm: $this->model = $this->model->whereMonth($de_NJ, $uGSQM, $BMgJx); goto n43Mv; HjJmI: case "\x59\105\x41\122": goto Q9tns; Q9tns: if ($uGSQM) { goto tx24g; } goto K7sNf; K7sNf: $uGSQM = "\x3d"; goto OQPXa; cDcno: goto s73zl; goto q5G9C; eBy1U: $this->model = $this->model->whereYear($de_NJ, $uGSQM, $BMgJx); goto cDcno; OQPXa: tx24g: goto eBy1U; q5G9C: case "\105\x58\x49\x53\124\x53": goto b1hTX; H59a_: rjMI0: goto TUOvK; JuQwc: throw new ErrorException("\111\156\160\x75\164\x20{$BMgJx}\x20\x6d\165\x73\164\x20\142\145\40\143\154\157\163\165\x72\x65\x20\146\165\x6e\143\164\x69\157\156"); goto H59a_; TUOvK: $this->model = $this->model->whereExists($BMgJx); goto jAG7d; jAG7d: goto s73zl; goto v2iJW; b1hTX: if ($BMgJx instanceof Closure) { goto rjMI0; } goto JuQwc; v2iJW: case "\110\x41\123": goto la07h; la07h: if ($BMgJx instanceof Closure) { goto WoQ7O; } goto goupp; ftdM7: WoQ7O: goto il9Db; goupp: throw new ErrorException("\111\x6e\160\165\164\x20{$BMgJx}\x20\155\x75\163\164\40\142\145\40\x63\x6c\157\163\165\162\x65\x20\146\x75\156\143\x74\151\157\x6e"); goto ftdM7; YQu71: goto s73zl; goto m8cVD; il9Db: $this->model = $this->model->whereHas($de_NJ, $BMgJx); goto YQu71; m8cVD: case "\x48\x41\123\115\x4f\x52\x50\x48": goto cMN8E; VoFyI: goto s73zl; goto z9nR_; LcHii: $this->model = $this->model->whereHasMorph($de_NJ, $BMgJx); goto VoFyI; j2vmw: m2wCZ: goto LcHii; cMN8E: if ($BMgJx instanceof Closure) { goto m2wCZ; } goto QWiQ8; QWiQ8: throw new ErrorException("\x49\x6e\160\165\164\40{$BMgJx}\40\x6d\x75\x73\x74\40\142\x65\40\143\154\157\163\x75\162\145\x20\146\x75\156\143\164\x69\157\x6e"); goto j2vmw; z9nR_: case "\104\x4f\105\123\116\124\110\x41\126\105": goto EXP6d; Rp5A_: goto s73zl; goto eCHBs; FGMez: vRua6: goto omiEt; EXP6d: if ($BMgJx instanceof Closure) { goto vRua6; } goto JZ3PL; omiEt: $this->model = $this->model->whereDoesntHave($de_NJ, $BMgJx); goto Rp5A_; JZ3PL: throw new ErrorException("\111\156\x70\x75\164\40{$BMgJx}\40\x6d\x75\x73\164\40\x62\145\40\x63\154\157\x73\165\x72\145\40\x66\165\x6e\143\164\x69\x6f\x6e"); goto FGMez; eCHBs: case "\104\x4f\105\123\x4e\124\110\x41\126\x45\x4d\x4f\x52\x50\x48": goto YMGEn; YMGEn: if ($BMgJx instanceof Closure) { goto YjmO_; } goto AEXra; sHY_2: goto s73zl; goto CvMKc; Ha9SU: YjmO_: goto c6fkI; c6fkI: $this->model = $this->model->whereDoesntHaveMorph($de_NJ, $BMgJx); goto sHY_2; AEXra: throw new ErrorException("\111\x6e\x70\x75\x74\40{$BMgJx}\x20\x6d\x75\163\164\40\142\145\x20\x63\154\157\163\x75\162\x65\x20\x66\x75\x6e\x63\164\151\x6f\156"); goto Ha9SU; CvMKc: case "\102\x45\x54\x57\105\x45\116": goto VP8ie; VP8ie: if (is_array($BMgJx)) { goto uHXDI; } goto TSiup; DP_0C: goto s73zl; goto dqWDl; U2_rS: $this->model = $this->model->whereBetween($de_NJ, $BMgJx); goto DP_0C; by2Sx: uHXDI: goto U2_rS; TSiup: throw new ErrorException("\x49\x6e\x70\x75\x74\40{$BMgJx}\40\155\x75\x73\40\x62\145\40\x61\156\40\141\162\x72\141\x79"); goto by2Sx; dqWDl: case "\x42\x45\124\127\x45\x45\116\103\x4f\114\x55\x4d\x4e\x53": goto DLZXA; DCX5s: throw new ErrorException("\x49\156\160\165\x74\40{$BMgJx}\40\155\x75\163\x20\142\x65\x20\141\156\x20\x61\x72\x72\141\x79"); goto uO6YX; ZN52Z: $this->model = $this->model->whereBetweenColumns($de_NJ, $BMgJx); goto vvJFk; DLZXA: if (is_array($BMgJx)) { goto NDn6i; } goto DCX5s; vvJFk: goto s73zl; goto W6H9a; uO6YX: NDn6i: goto ZN52Z; W6H9a: case "\x4e\x4f\124\102\x45\124\x57\x45\105\116": goto xJIuA; xJIuA: if (is_array($BMgJx)) { goto oe_qB; } goto dQlPj; dQlPj: throw new ErrorException("\x49\x6e\x70\165\x74\40{$BMgJx}\40\155\165\x73\40\142\x65\x20\141\156\40\x61\162\162\x61\171"); goto Ups4E; Ups4E: oe_qB: goto b3rW6; b3rW6: $this->model = $this->model->whereNotBetween($de_NJ, $BMgJx); goto xjqAB; xjqAB: goto s73zl; goto pB2tE; pB2tE: case "\x4e\x4f\124\102\x45\x54\x57\105\105\x4e\103\117\114\x55\x4d\116\x53": goto y9nYj; OOXM3: goto s73zl; goto whzfu; uVozp: TFOCv: goto lXsI1; efsXY: throw new ErrorException("\x49\x6e\x70\165\x74\40{$BMgJx}\40\155\165\x73\40\x62\145\x20\141\156\x20\141\162\162\141\171"); goto uVozp; lXsI1: $this->model = $this->model->whereNotBetweenColumns($de_NJ, $BMgJx); goto OOXM3; y9nYj: if (is_array($BMgJx)) { goto TFOCv; } goto efsXY; whzfu: case "\x52\101\x57": $this->model = $this->model->whereRaw($BMgJx); goto s73zl; case "\x46\111\x4e\x44\x5f\x49\116\x5f\123\105\x54": $this->applyFindInSetCondition($de_NJ, $BMgJx); goto s73zl; default: $this->model = $this->model->where($de_NJ, $Y3Cc0, $BMgJx); } goto bjxVm; kgW17: rpAl2: goto pcJK9; bjxVm: AcgDF: goto eNOsD; mIcWT: Pw4Lu: goto zJkv4; Jk0On: $Y3Cc0 = preg_replace("\x2f\x5c\x73\x5c\x73\x2b\57", "\40", trim($Y3Cc0)); goto jaAJB; KxP7C: if (count($uGSQM) > 1) { goto Dux0t; } goto x4OIB; aep2D: goto QyErg; goto eDbyR; x4OIB: $uGSQM = null; goto aep2D; vhwn9: $uGSQM = $uGSQM[1]; goto wW0lU; zJkv4: } gbhCW: } protected function applyFindInSetCondition($de_NJ, $BMgJx) { goto kL_rU; gD_i2: exsfH: goto A0tNm; kL_rU: if (is_array($BMgJx)) { goto gSpuk; } goto z9NmY; K1vhH: gSpuk: goto zJQde; zJQde: foreach ($BMgJx as $JCs88) { $this->model = $this->model->whereRaw("\x46\111\116\104\x5f\111\116\x5f\x53\x45\124\x28\x3f\x2c\x20{$de_NJ}\x29", [$JCs88]); c4Q7h: } goto gD_i2; z9NmY: throw new ErrorException("\111\156\x70\x75\x74\40{$BMgJx}\x20\155\165\x73\x74\40\x62\x65\40\x61\x6e\40\141\162\162\141\171\x20\146\x6f\x72\40\106\x49\x4e\x44\x5f\x49\116\137\x53\105\124"); goto K1vhH; A0tNm: } public function getOne($RxOxB) { goto App7t; App7t: $R3wwf = $this->gets($RxOxB); goto QduK8; hjOA6: goto D3o3Z; goto wpJ53; gVFk9: return []; goto hjOA6; QduK8: if (!empty($R3wwf)) { goto ikn1V; } goto gVFk9; Be7M6: D3o3Z: goto T13iD; uYVw_: return current($R3wwf); goto Be7M6; wpJ53: ikn1V: goto uYVw_; T13iD: } public function gets($afw6o, $PDJ8X = true) { goto ZAfp3; BwYWr: return $YEACD ? $YEACD->toArray() : []; goto Wa4e2; ZAfp3: if (is_array($afw6o)) { goto wWYTD; } goto VExcY; VExcY: $afw6o = [$afw6o]; goto uFPde; cxO0f: if (!$PDJ8X) { goto PLoE_; } goto sLAYx; VGSrj: $CPW3O = $this->model->getKeyName(); goto gKzLZ; gKzLZ: $YEACD = $this->findWhereIn($CPW3O, $afw6o); goto cxO0f; KSS_Y: PLoE_: goto BwYWr; uFPde: wWYTD: goto VGSrj; sLAYx: $YEACD = $YEACD->keyBy($CPW3O); goto KSS_Y; Wa4e2: } public function list($rV3aw, $hiypA = null) { goto bw1gI; FDo30: $this->pushCriteria($rV3aw); goto MVROx; MVROx: $IB5aa = parent::paginate($hiypA)->toArray(); goto InCRW; InCRW: $IB5aa["\154\151\155\151\x74"] = $hiypA; goto oYi6T; oYi6T: return $IB5aa; goto acb1B; bw1gI: $hiypA = intval($hiypA ?? config("\162\145\x70\157\163\x69\x74\157\x72\x79\x2e\160\x61\147\x69\156\x61\164\151\157\156\x2e\154\151\x6d\x69\x74", 15)); goto FDo30; acb1B: } public function listKey(Criteria $rV3aw, $hiypA = null) { goto Ro4Xp; OqjsB: return $IB5aa; goto mTBfV; yhGVY: $IB5aa = parent::paginate($hiypA)->pluck($this->model->getKeyName())->toArray(); goto fy13a; PflZu: $this->pushCriteria($rV3aw); goto yhGVY; Ro4Xp: $hiypA = intval($hiypA ?? config("\162\x65\160\157\x73\x69\x74\x6f\x72\x79\x2e\160\141\147\x69\x6e\141\164\151\x6f\156\56\154\x69\x6d\x69\x74", 15)); goto PflZu; fy13a: $IB5aa["\x6c\x69\155\151\164"] = $hiypA; goto OqjsB; mTBfV: } public function finds(array $ate9G, $i_0e_ = array(), $Qydtf = null, $R3wwf = null) { goto PlnxZ; t3Jow: $YEACD = $this->findWhere($ate9G)->keyBy($CPW3O); goto KGd2b; ccOGI: RqSb1: goto IkFdj; UY4To: $this->applyConditions($ate9G); goto OvwN0; KGd2b: goto k97HJ; goto RO53S; psmWx: foreach ($i_0e_ as $N16YQ => $wa_3u) { $this->orderBy($N16YQ, $wa_3u); ruJGb: } goto ccOGI; wUAO_: $this->resetModel(); goto a4bAh; OvwN0: $YEACD = $this->model->paginate($R3wwf, ["\x2a"], "\x70\x61\147\145", $Qydtf)->keyBy($CPW3O); goto wUAO_; a4bAh: k97HJ: goto nwfke; nwfke: return $YEACD ? $YEACD->toArray() : []; goto VaQcI; RO53S: pb0bS: goto UY4To; SN5x6: AxBZw: goto psmWx; PlnxZ: $CPW3O = $this->model->getKeyName(); goto W56nL; IkFdj: if ($Qydtf && $R3wwf) { goto pb0bS; } goto t3Jow; GrW4g: $i_0e_ = [$CPW3O => "\x44\105\x53\103"]; goto SN5x6; W56nL: if (!empty($i_0e_)) { goto AxBZw; } goto GrW4g; VaQcI: } public function findKey(array $ate9G) { $YEACD = $this->findWhere($ate9G)->pluck($this->model->getKeyName()); return $YEACD ? $YEACD->toArray() : []; } public function findOne(array $ate9G, $i_0e_ = array()) { $YEACD = $this->finds($ate9G, $i_0e_); return !empty($YEACD) ? current($YEACD) : []; } public function incrementFieldByIds(array $afw6o, $ukbM_, $JCs88 = 1) { $CPW3O = $this->model->getKeyName(); return $this->model->whereIn($CPW3O, $afw6o)->increment($ukbM_, $JCs88); } public function decrementFieldByIds(array $afw6o, $ukbM_, $JCs88 = 1) { $CPW3O = $this->model->getKeyName(); return $this->model->whereIn($CPW3O, $afw6o)->decrement($ukbM_, $JCs88); } public function getNum($ate9G = array()) { $ExY4O = $this->findWhere($ate9G)->count(); return $ExY4O; } }
